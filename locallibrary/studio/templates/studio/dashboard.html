{% extends 'studio/base.html' %}

{% block content %}
<header class="mb-4">
    <h1 class="text-primary">Мои заявки</h1>

    <div class="btn-group mb-3" role="group" aria-label="Фильтр по статусу">
        <a href="{% url 'studio:dashboard' %}" class="btn btn-outline-primary {% if not selected_status %}active{% endif %}">Все</a>
        <a href="{% url 'studio:dashboard' %}?status=new" class="btn btn-outline-primary {% if selected_status == 'new' %}active{% endif %}">Новые</a>
        <a href="{% url 'studio:dashboard' %}?status=in_progress" class="btn btn-outline-primary {% if selected_status == 'in_progress' %}active{% endif %}">В работе</a>
        <a href="{% url 'studio:dashboard' %}?status=done" class="btn btn-outline-primary {% if selected_status == 'done' %}active{% endif %}">Выполненные</a>
    </div>
</header>

{% if applications %}
<ul class="list-group">
    {% for a in applications %}
    <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
        <div>
            <a href="{% url 'studio:application_detail' a.pk %}" class="fw-semibold text-decoration-none">
                {{ a.created|date:"d.m.Y H:i" }} - {{ a.title }} ({{ a.get_status_display }})
            </a>
            {% if a.image %}
                <br>
                <img src="{{ a.image.url }}" alt="{{ a.title }}" width="120" class="mt-2 rounded">
            {% endif %}
        </div>
        <form method="post" action="{% url 'studio:delete_application' a.pk %}" class="ms-3">
            {% csrf_token %}
            <button type="submit" class="btn btn-outline-danger btn-sm">Удалить</button>
        </form>
    </li>
    {% endfor %}
</ul>
{% else %}
<p class="text-muted">У вас пока нет заявок.</p>
{% endif %}

<div class="mt-4">
    <a href="{% url 'studio:create_application' %}" class="btn btn-primary">
        Создать новую заявку
    </a>
</div>
{% endblock %}
