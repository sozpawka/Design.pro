{% extends "studio/base.html" %}
{% block content %}

<div class="container py-5">

  <h1 class="display-4 mb-4 text-primary">Главная</h1>

  <div class="alert alert-info d-flex align-items-center justify-content-between shadow-sm rounded-3 p-4 mb-5">
    <div class="d-flex align-items-center">
      <i class="bi bi-clock-history fs-3 me-3"></i>
      <span class="fs-5">Заявок в статусе <strong>«Принято в работу»</strong>:</span>
    </div>
    <span class="badge bg-primary fs-4 px-4 py-2 shadow">{{ in_progress_count }}</span>
  </div>

  <h2 class="mb-4 border-bottom pb-2 text-secondary">Последние выполненные</h2>

  {% if recent_done %}
  <div class="row g-4">
    {% for a in recent_done %}
    <div class="col-12 col-sm-6 col-md-4 col-lg-3">
      <div class="card h-100 shadow-sm border-0 hover-shadow">
        {% if a.design_image %}
          <img src="{{ a.design_image.url }}" class="card-img-top" alt="{{ a.title }}" style="object-fit: cover; height: 180px;">
        {% elif a.image %}
          <img src="{{ a.image.url }}" class="card-img-top" alt="{{ a.title }}" style="object-fit: cover; height: 180px;">
        {% else %}
          <svg class="bd-placeholder-img card-img-top" width="100%" height="180" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder" preserveAspectRatio="xMidYMid slice" focusable="false">
            <title>Нет изображения</title>
            <rect width="100%" height="100%" fill="#e9ecef"></rect>
            <text x="50%" y="50%" fill="#6c757d" dy=".3em" text-anchor="middle">Нет изображения</text>
          </svg>
        {% endif %}
        <div class="card-body d-flex flex-column">
          <h5 class="card-title text-primary">{{ a.title }}</h5>
          <p class="card-text text-muted mb-2">{{ a.category.name }}</p>
          <p class="card-text mt-auto"><small class="text-muted">Создано: {{ a.created }}</small></p>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
    <div class="alert alert-warning shadow-sm" role="alert">
      Пока нет завершённых заявок
    </div>
  {% endif %}

</div>

<style>
  .hover-shadow:hover {
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    transition: box-shadow 0.3s ease-in-out;
  }
</style>

{% endblock %}
